function readCSV(b){var a=null;var c=b;$.ajax({url:c,type:"get",dataType:"text",async:false,success:function(d){a=d}});return a}function exportToCsv(e,c){data=e.map(objToString);data=data.join("\n");data=objToString(_.keys(e[0]))+"\n"+data;offense_type="ucr_offenses_";if($("#rate").is(":checked")){offense_type+="rate_"}else{offense_type+="count_"}if(c=="offenses"){filename=offense_type}if(c=="arrests"){filename="ucr_arrests_"}filename+=agencies[$("#agency_dropdown").val()]+"_"+state_values[$("#state_dropdown").val()]+".csv";var a=new Blob([data],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(a,filename)}else{var d=document.createElement("a");if(d.download!==undefined){var b=URL.createObjectURL(a);d.setAttribute("href",b);d.setAttribute("download",filename);d.style.visibility="hidden";document.body.appendChild(d);d.click();document.body.removeChild(d)}}}function makeCrimeDropdown(){$("#crime_dropdown").empty();$.each(crime_values,function(b,a){$("#crime_dropdown").append(new Option(a,b))});$("#crime_dropdown").val("aggravated_assault")}function makeStateDropdown(a){$.each(state_values,function(c,b){$(a).append(new Option(b,c))});$(a).val(4)}function countToRate(b){data_keys=_.keys(b);for(var a=0;a<data_keys.length;a++){temp_match=data_keys[a].replace(/act_|clr_18_|clr_|unfound_/,"");if(temp_match!=data_keys[a]&temp_match!="officers_assaulted"&temp_match!="officers_killed_by_felony"){rate_val=b[data_keys[a]]/b.population*100000;rate_val=parseFloat(rate_val).toFixed(2);b[data_keys[a]]=rate_val;new_key=data_keys[a]+"_rate";Object.defineProperty(b,new_key,Object.getOwnPropertyDescriptor(b,data_keys[a]));delete b[data_keys[a]]}}return b};