function readCSV(b){var a=null;var c=b;$.ajax({url:c,type:"get",dataType:"text",async:false,success:function(d){a=d}});return a}function exportToCsv(e,c){data=e.reverse();data=data.map(objToString);data=data.join("\n");data=objToString(_.keys(e[0]))+"\n"+data;offense_type="ucr_offenses_";if($("#rate").is(":checked")){offense_type+="rate_"}else{offense_type+="count_"}if(c=="offenses"){filename="ucr_"+offense_type;filename+=offense_agencies[$("#agency_dropdown").val()]+"_"+state_values[$("#state_dropdown").val()]+".csv"}else{if(c=="arrests"){filename="ucr_arrests_";filename+=arrest_agencies[$("#arrests_agency_dropdown").val()]+"_"+state_values[$("#arrests_state_dropdown").val()]+".csv"}else{if(c=="leoka"){filename="ucr_police_";filename+=leoka_agencies[$("#leoka_agency_dropdown").val()]+"_"+state_values[$("#leoka_state_dropdown").val()]+".csv"}}}var a=new Blob([data],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(a,filename)}else{var d=document.createElement("a");if(d.download!==undefined){var b=URL.createObjectURL(a);d.setAttribute("href",b);d.setAttribute("download",filename);d.style.visibility="hidden";document.body.appendChild(d);d.click();document.body.removeChild(d)}}}function makeCrimeDropdown(a,b){if(a=="crime"){crime=crime_values;starter="all_crimes"}else{if(a=="arrest"){crime=arrest_values;starter="agg_assault"}else{if(a=="leoka"){crime=leoka_values;starter="total_officers"}}}$.each(crime,function(d,c){$(b).append(new Option(c,d))});$(b).val(starter)}function makeStateDropdown(a){$.each(state_values,function(c,b){$(a).append(new Option(b,c))});$(a).val(4)}function makeArrestCategoriesDropdown(){$.each(arrest_categories,function(b,a){$("#arrests_category_dropdown").append(new Option(a,b))});$("#arrests_category_dropdown").val("tot_arrests")}function countToRate(b){data_keys=_.keys(b);for(var a=0;a<data_keys.length;a++){temp_match=data_keys[a].replace(/act_|clr_18_|clr_|unfound_/,"");if(temp_match!=data_keys[a]||temp_match.includes("officer")){rate_val=b[data_keys[a]]/b.population*100000;rate_val=parseFloat(rate_val).toFixed(2);if(isNaN(rate_val)){rate_val=0}b[data_keys[a]]=rate_val;new_key=data_keys[a]+"_rate";Object.defineProperty(b,new_key,Object.getOwnPropertyDescriptor(b,data_keys[a]));delete b[data_keys[a]]}}return b}function getStateAgencies(a){url="https://raw.githubusercontent.com/jacobkap/crimedatatool_helper/master/data/";if(a=="crime"){url+="offenses/"+state_values[$("#state_dropdown").val()]+"_agency_choices.json"}else{if(a=="arrest"){url+="arrests/"+state_values[$("#arrests_state_dropdown").val()]+"_agency_choices.json"}else{if(a=="leoka"){url+="leoka/"+state_values[$("#leoka_state_dropdown").val()]+"_agency_choices.json"}}}var b=$.getJSON({url:url,type:"get",dataType:"json",async:false,success:function(c){result=c}});b=b.responseJSON;return(b)}function updateAgencies(a,c,b){agencies=getStateAgencies(a);$(c).empty();$.each(agencies,function(e,d){$(c).append(new Option(d,e))});$(c).val(0);$(".simple-select").trigger("chosen:updated");return agencies};