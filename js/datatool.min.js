function resizeChosen(){$(".chosen-container").each(function(){$(this).attr("style","width: 85%")})}function myFunction(){var a=document.getElementById("myTopnav");if(a.className==="topnav"){a.className+=" responsive"}else{a.className="topnav"}}function objToString(b){var c="";for(var a in b){if(b.hasOwnProperty(a)){c+=b[a]+","}}c=c.slice(0,-1);return c}function subsetColumns(b,a){b.shift();b=_.map(b,function(c){return _.pick(c,a)});b=b.map(objToString);b=b.join("\n");b=a.toString()+"\n"+b;return(b)}function getStateAgencies(a){url="https://raw.githubusercontent.com/jacobkap/crimedatatool_helper/master/data/";if(a=="crime"){url+="offenses/"+state_values[$("#state_dropdown").val()]+"_agency_choices.json"}var b=$.getJSON({url:url,type:"get",dataType:"json",async:false,success:function(c){result=c}});b=b.responseJSON;return(b)}function getStateData(a){url="https://raw.githubusercontent.com/jacobkap/crimedatatool_helper/master/data/";if(a=="offenses"){state=state_values[$("#state_dropdown").val()];state=state.replace(/ /g,"_");agencies=offense_agencies[$("#agency_dropdown").val()];agencies=agencies.replace(/ /g,"_");agencies=agencies.replace(/:/g,"_");agencies=agencies.replace(/__/g,"_");state=state.replace(" ","_");url+="offenses/"+state+"_"+agencies}if(a=="arrests"){state=state_values[$("#arrests_state_dropdown").val()];state=state.replace(" ","_");state=state.replace(" ","_");url+=state}url+=".csv";stateData=readCSV(url);stateData=stateData.split("\n");return stateData}function getAgencyData(a,b){agencyData=data_object_fun(a,b);if($("#rate").is(":checked")){agencyData=_.map(agencyData,function(c){return countToRate(c)})}return agencyData}function main(c,a,b){stateData=getStateData(c);headers=stateData[0];colsForGraph=getCrimeColumns(headers,c);tableData=getAgencyData(stateData,headers);tableData.pop();graphData=subsetColumns(tableData,colsForGraph);return[tableData,graphData,headers]}function getCrimeColumns(a,c){if(c=="offenses"){crime=$("#crime_dropdown").val()}if(c=="arrests"){crime=$("#arrests_crime_dropdown").val();crime+="_"+$("#arrests_category_dropdown").val()}a=a.split(",");columnNames=["year"];for(var b=0;b<a.length;b++){if(a[b].includes(crime)){columnNames.push(a[b])}}return(columnNames)}function data_object_fun(a,f){f=f.split(",");var g=[];for(var c=0;c<a.length;c++){temp=a[c];var d=temp.split(",");var e={};for(var b=0;b<d.length;b++){e[f[b].trim()]=d[b].trim()}g.push(e)}return(g)};