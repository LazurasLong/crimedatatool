function resizeChosen(){$(".chosen-container").each(function(){$(this).attr("style","width: 85%")})}function myFunction(){var a=document.getElementById("myTopnav");if(a.className==="topnav"){a.className+=" responsive"}else{a.className="topnav"}}function objToString(b){var c="";for(var a in b){if(b.hasOwnProperty(a)){c+=b[a]+","}}c=c.slice(0,-1);return c}function subsetColumns(c,b,a){c.shift();if($("#rate").is(":checked")){b=_.map(b,function(d){return d+"_rate"});if(a=="table"){b[0]="agency";b[1]="year";b[2]="state";b[3]="population";b[4]="ORI"}else{b[0]="year"}}c=_.map(c,function(d){return _.pick(d,b)});if(a=="graph"){c=c.map(objToString);c=c.join("\n");c=b.toString()+"\n"+c}return(c)}function getStateData(a){url="https://raw.githubusercontent.com/jacobkap/crimedatatool_helper/master/data/";if(a=="offenses"){state=state_values[$("#state_dropdown").val()];state=state.replace(/ /g,"_");state=state.replace(" ","_");agencies=offense_agencies[$("#agency_dropdown").val()];agencies=agencies.replace(/ /g,"_");agencies=agencies.replace(/:/g,"_");agencies=agencies.replace(/__/g,"_");url+="offenses/"+state+"_"+agencies}if(a=="arrest"){state=state_values[$("#arrests_state_dropdown").val()];state=state.replace(/ /g,"_");state=state.replace(" ","_");agencies=arrest_agencies[$("#arrests_agency_dropdown").val()];agencies=agencies.replace(/ /g,"_");agencies=agencies.replace(/:/g,"_");agencies=agencies.replace(/__/g,"_");url+="arrests/"+state+"_"+agencies}url+=".csv";stateData=readCSV(url);stateData=stateData.split("\n");return stateData}function getAgencyData(a,b){agencyData=data_object_fun(a,b);if($("#rate").is(":checked")){agencyData=_.map(agencyData,function(c){return countToRate(c)})}return agencyData}function main(c,a,b){stateData=getStateData(c);headers=stateData[0];colsForGraph=getCrimeColumns(headers,c,"graph");colsForTable=getCrimeColumns(headers,c,"table");tableData=getAgencyData(stateData,headers);tableData.pop();graphData=subsetColumns(tableData,colsForGraph,"graph");return[tableData,graphData,headers,colsForTable]}function getCrimeColumns(a,d,b){a=a.split(",");if(b=="graph"){columnNames=["year"]}else{columnNames=["agency","year","state","population","ORI"]}if(d=="offenses"){crime=$("#crime_dropdown").val()}if(d=="arrest"){crime=$("#arrests_crime_dropdown").val();if(b=="graph"){crime+="_"+$("#arrests_category_dropdown").val()}}for(var c=0;c<a.length;c++){if(a[c].includes(crime)){columnNames.push(a[c])}}return(columnNames)}function data_object_fun(a,f){f=f.split(",");var g=[];for(var c=0;c<a.length;c++){temp=a[c];var d=temp.split(",");var e={};for(var b=0;b<d.length;b++){e[f[b].trim()]=d[b].trim()}g.push(e)}return(g)};